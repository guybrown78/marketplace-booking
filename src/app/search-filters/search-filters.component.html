<div class="search-filters form-hero-card">

	<form 
		nz-form 
		[formGroup]="searchFiltersForm" 
		(ngSubmit)="submitForm()" 
		nzLayout="vertical">

		<nz-form-item>
			<nz-form-label nzFor="delegate">
				Delegate 
				<span 
					class="label-prefix" 
					*ngIf="selectedDelegate"
				>
					{{ selectedDelegate | getUsersTennantJobRole: tennantService.tennant }}
				</span> 
			</nz-form-label>

			<nz-form-control 
				nzErrorTip="The input is not valid E-mail!" 
				[nzTooltipTitle]="delegateTooltipTemplate" 
				nzTooltipPlacement="right" 
				nz-tooltip
				[nzTooltipTrigger]="null"
				[nzTooltipVisible]="!searchFiltersForm.get('delegate')?.touched && !forceCloseTT"
			>
				<nz-input-group [nzPrefix]="prefixUser">
					<input 
						placeholder="Start typing delegates name" 
						nz-input 
						formControlName="delegate" 
						id="delegate" 
						(input)="onDelegateInput($event)" 
						[nzAutocomplete]="autoDelegate" 
					/>
					<nz-autocomplete 
						nzBackfill 
						#autoDelegate
					>
						<nz-auto-option 
							*ngIf="delegatesLoading"
							nzDisabled 
							nzCustomContent
						>
							<i nz-icon nzType="loading" class="loading-icon"></i> Loading Delegates...
						</nz-auto-option>
						
						<ng-container *ngFor="let option of delegateOptions">
							<nz-auto-option 
								*ngIf="!delegatesLoading"
								[nzValue]="(option | getUsersFullName)"
								(click)="onDelegateAutoSelected(option)"
							>{{ option | getUsersFullName }}</nz-auto-option>
						</ng-container>
					
					</nz-autocomplete>


				</nz-input-group>
			</nz-form-control>
		</nz-form-item>

		<nz-form-item>
			<nz-form-label nzFor="course">Course</nz-form-label>
			<nz-form-control nzErrorTip="You need to input a course">
				<nz-input-group [nzPrefix]="prefixSearch">
					<input 
						placeholder="Start typing course name" 
						nz-input 
						formControlName="course" 
						id="course" 
						(input)="onCourseInput($event)" 
						[nzAutocomplete]="autoCourse" 
					/>
					<nz-autocomplete 
						nzBackfill 
						#autoCourse
					>
						<nz-auto-option 
							*ngIf="coursesLoading"
							nzDisabled 
							nzCustomContent
						>
							<i nz-icon nzType="loading" class="loading-icon"></i> Loading Courses...
						</nz-auto-option>
						
						<ng-container *ngFor="let option of courseOptions">
							<nz-auto-option 
								*ngIf="!coursesLoading"
								[nzValue]="option.name"
								(click)="onCoursesAutoSelected(option)"
							>{{ option.name }}</nz-auto-option>
						</ng-container>

						<nz-auto-option 
							*ngIf="!coursesLoading && courseOptions.length"
							nzDisabled 
							nzCustomContent
							class="alternative-course-option"
						>
							<span nzTypography class="blue">
								Can't find your choice? 
								<a href="#" class="underlined">Use this form</a>
							</span>
						</nz-auto-option>
			
					</nz-autocomplete>
				</nz-input-group>
			</nz-form-control>
		</nz-form-item>

		<nz-form-item>
			<nz-form-label nzFor="type">Type</nz-form-label>
			
			<nz-form-control>
				
				<div class="fake-input-group">
					<i nz-icon nzType="menu" nzTheme="outline" class="fake-input-group-prefix-icon"></i>
					<nz-select 
						placeholder="Select course type" 
						formControlName="type" 
						id="type"
						class="force-select-prefix"
					>
						<nz-option *ngFor="let type of typeOptions" 
							[nzValue]="type.value"
							[nzLabel]="type.name"
						></nz-option>
						<!-- <nz-option 
							nzValue="eLearn"
							nzLabel="E-Learn"
						></nz-option>
						<nz-option 
							nzValue="vLearn"
							nzLabel="V-Learn"
						></nz-option> -->
					</nz-select>
				</div>

				<!-- <nz-input-group [nzPrefix]="prefixType"> -->
					
					<!-- <input nz-input formControlName="type" id="type" />
					<nz-autocomplete 
						[nzDataSource]="typeOptions" 
						#autoType
					></nz-autocomplete> 
				 </nz-input-group> -->
			</nz-form-control> 

		</nz-form-item>

		<!-- <nz-form-item>
			<nz-form-label nzFor="location">Location</nz-form-label>
			<nz-form-control>
				<nz-input-group [nzPrefix]="prefixLocation">
					<input nz-input formControlName="location" id="location" />
				</nz-input-group>
			</nz-form-control>
		</nz-form-item> -->
		<nz-form-item>
			<nz-form-label nzFor="location">Location</nz-form-label>
			<nz-form-control>
				
				<div class="fake-input-group">
					<i nz-icon nzType="environment" nzTheme="outline" class="fake-input-group-prefix-icon"></i>
					<nz-select 
						placeholder="Select a location" 
						formControlName="location" 
						id="location"
						class="force-select-prefix"
					>
						<nz-option *ngFor="let location of locationOptions" 
							[nzValue]="location.name"
							[nzLabel]="location.name"
						></nz-option>
					</nz-select>
				</div>
			</nz-form-control> 

		</nz-form-item>

		<nz-form-item>
			<nz-form-label nzFor="startDate">Start Date</nz-form-label>
			<nz-form-control>
				<div class="fake-input-group">
					<i nz-icon nzType="calendar" nzTheme="outline" class="fake-input-group-prefix-icon"></i>
					<nz-date-picker 
						class="date-picker"
						[nzFormat]="dateFormat"
						formControlName="startDate" 
						id="startDate"
						[nzSuffixIcon]="suffixDate"
					></nz-date-picker>
				</div>
				<!-- <nz-input-group [nzPrefix]="prefixDate"> -->
					<!-- <input nz-input formControlName="startDate" id="startDate" /> -->
					<!-- <nz-date-picker 
						class="date-picker"
						formControlName="startDate" 
						id="startDate"
						[nzSuffixIcon]="suffixDate"
					></nz-date-picker> -->
				<!-- </nz-input-group> -->
			</nz-form-control>
		</nz-form-item>

		<!-- <nz-form-item class="submit-area">
			<nz-form-control> -->
				<button 
					[disabled]="!courseService.course" 
					nz-button 
					nzType="primary"
				>Search</button>
			<!-- </nz-form-control>
		</nz-form-item> -->


	</form>
</div>


<ng-template #prefixUser>
	<i nz-icon nzType="user"></i>
</ng-template>
<ng-template #prefixSearch>
	<i nz-icon nzType="search"></i>
</ng-template>
<ng-template #prefixType>
	<i nz-icon nzType="menu"></i>
</ng-template>
<ng-template #prefixLocation>
	<i nz-icon nzType="environment" nzTheme="outline"></i>
</ng-template>
<ng-template #prefixDate>
	<i nz-icon nzType="calendar" nzTheme="outline"></i>
</ng-template>
<ng-template #suffixDate></ng-template>

<ng-template #delegateTooltipTemplate>
	<div class="tooltip-container">
		<span>If you want to add multiple delegates, you can leave this&nbsp;blank</span>
		<button nz-button nzSize="small" nzShape="circle" class="navy" (click)="onForceCloseTT()">
			<i nz-icon nzType="close"></i>
		</button>
	</div>
	
</ng-template>